I"ÃP<p>##UITableview</p>

<p>ä»08å¹´åˆ°ç°åœ¨å¼€å‘è¿‡çš„iOSåº”ç”¨ä¸è®¡å…¶æ•°äº†ï¼Œä½†æ˜¯é¢è¯•å¾ˆå¤šäººçš„æ—¶å€™ï¼Œå‘ç°ä¾ç„¶å¾ˆå¤šåŒå­¦åœ¨æœ€åŸºæœ¬çš„åˆ—è¡¨æ§ä»¶ä¸Šæ‡‚å¾—ä¸å¤Ÿæ·±ï¼Œä¸‹é¢å°±ç»“åˆå„æ–¹é¢çš„èµ„æ–™è¿›è¡Œå†ä¸€æ¬¡è®²è§£ã€‚</p>

<p>æˆ‘ä»¬éƒ½çŸ¥é“çº¯ä»£ç æ˜¯æ•ˆç‡æœ€é«˜çš„ï¼Œä½†æ˜¯åœ¨å¼€å‘æˆæœ¬ä¸Šå·²ç»è¶Šæ¥è¶Šä¸å¦‚ä½¿ç”¨Storyboardæ€§ä»·æ¯”é«˜ï¼Œé€Ÿåº¦å¿«ï¼Œæ‰€ä»¥æœ¬æ–‡è¯•å›¾ç»“åˆUIStoryboardæ¥æè¿°ä¸€æ•´å¥—æ–¹æ¡ˆã€‚</p>

<h2 id="ç®€å•é…ç½®">###ç®€å•é…ç½®</h2>
<p>åœ¨Storyboardä¸­æ‹–å…¥UITableViewControllerï¼Œå¹¶ä¸”ä¿®æ”¹æ¶‚æ¶‚ç”»ç”»<br />
åœ¨ä»£ç åŒºnew Fileç”Ÿæˆä¸€ä¸ªåŸºäºUITableviewControllerçš„è‡ªå®šä¹‰ç±»ï¼Œæˆ‘è¿™é‡Œæš‚æ—¶å–åä¸ºHomeã€‚å› ä¸ºä¸»é¡µå°±æ˜¯ä¸€ä¸ªå¤æ‚çš„åˆ—è¡¨çš„ä¸åœ¨å°‘æ•°å§ï¼Ÿå‘µå‘µã€‚<br />
ç„¶ååœ¨Identity insepctoré‡Œä¿®æ”¹å¯¹åº”çš„Class nameï¼Œä½¿å¾—ä»£ç ä¸Storyboardäº§ç”Ÿå…³è”ã€‚<br />
<img src="http://img226.poco.cn/mypoco/myphoto/20140120/13/17456374520140120133117055.jpg" alt="" /> 
æƒ³è¦åšä¸‹æ‹‰åˆ·æ–°å˜›ï¼Ÿç³»ç»Ÿè‡ªå¸¦äº†ä¸€ä¸ªç»™ä½ ï¼Œå¹¶ä¸”å¯ä»¥è‡ªå®šä¹‰æ¢æ ‡é¢˜å“¦ã€‚å¾ˆå¤šäººçœŸçš„ä¸çŸ¥é“åœ¨å“ªå„¿é€‰ä¸­ï¼Œè¯·çœ‹ä¸‹å›¾ï¼Œå…ˆé€‰ä¸­UITableviewControllerï¼Œç„¶ååœ¨é€‰é¡¹å¡ä¸­enableè¿™ä¸ªrefreshé€‰é¡¹ï¼Œå°±è‡ªåŠ¨å®Œæˆäº†ã€‚
å¯¹åº”çš„ä»£ç è¿˜æ˜¯å¤åˆ¶è¿›å»ï¼Œå°±ä¼šè‡ªåŠ¨è§¦å‘ã€‚<br />
<img src="http://img226.poco.cn/mypoco/myphoto/20140120/14/17456374520140120143455079.jpg" alt="" /></p>

<p>ç„¶åä½ éœ€è¦å¯¹UITableViewåšä¸€äº›ç®€å•çš„é…ç½®ï¼Œé¦–å…ˆè¦é€‰ä¸­UITableViewï¼Œå¾ˆå¤šäººçœ‹ä¸åˆ°é€‰é¡¹ï¼Œæ˜¯å› ä¸ºé»˜è®¤å…³é—­äº†ã€‚ã€‚
<img src="http://img226.poco.cn/mypoco/myphoto/20140120/13/17456374520140120134209098.jpg" alt="" /></p>

<p>ä¸‹å›¾æ˜¯å¯¹UITableviewçš„ç®€å•é…ç½®ã€‚</p>

<p>Contentæ˜¯åŠ¨æ€åˆ—è¡¨/é™æ€åˆ—è¡¨ï¼Œå¦‚æœæ˜¯é™æ€çš„ï¼Œé‚£ä½ åŸºæœ¬ä¸ç”¨å†™ä»£ç å°±èƒ½æ‰€è§å³æ‰€å¾—ï¼Œè­¬å¦‚â€œè®¾ç½®â€é¡µé¢å°±å¯ä»¥å¥—ç”¨ã€‚ä½†æ˜¯è¯¸å¦‚å¾®åšå•¦ï¼Œæœ‹å‹åœˆï¼Œè¿˜æ˜¯è€å®çš„ç”¨åŠ¨æ€åˆ—è¡¨ï¼Œç”¨ä»£ç æ§åˆ¶ã€‚<br />
Prototype CellsæŒ‡ä¼šå‡ºç°çš„cellæœ‰å‡ ç§ç±»å‹ã€‚è¿™ä¸ªåé¢å†è®²ã€‚<br />
Styleæ•ˆæœç°åœºè¯•ä¸€ä¸‹å°±çœ‹å‡ºæ¥äº†<br />
SeparatoræŒ‡çš„åˆ†éš”è¡Œæ ·å¼ã€‚<br />
<img src="http://img226.poco.cn/mypoco/myphoto/20140120/13/17456374520140120134255017.jpg" alt="" /></p>

<p>ç„¶åä½ å°±éœ€è¦ä»£ç ä¸­åšä¸€äº›ç®€å•çš„é…ç½®äº†,æˆ‘åªåˆ—é‡è¦çš„ï¼Œè¿™é‡Œä¸æ˜¯åŸºç¡€æ•™ç¨‹ï¼ŒåŸºç¡€çš„è¿˜æ˜¯è€å®çš„çœ‹æ•™ç§‘ä¹¦</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="k">-</span> <span class="p">(</span><span class="n">NSInteger</span><span class="p">)</span><span class="nf">numberOfSectionsInTableView</span><span class="p">:(</span><span class="n">UITableView</span> <span class="o">*</span><span class="p">)</span><span class="nv">tableView</span> <span class="c1">//å‡ ç»„
</span><span class="k">-</span> <span class="p">(</span><span class="n">NSInteger</span><span class="p">)</span><span class="nf">tableView</span><span class="p">:(</span><span class="n">UITableView</span> <span class="o">*</span><span class="p">)</span><span class="nv">tableView</span> <span class="nf">numberOfRowsInSection</span><span class="p">:(</span><span class="n">NSInteger</span><span class="p">)</span><span class="nv">section</span><span class="c1">//æ¯ä¸€ç»„åˆ†åˆ«å‡ è¡Œ
</span><span class="k">-</span><span class="p">(</span><span class="n">CGFloat</span><span class="p">)</span><span class="nf">tableView</span><span class="p">:(</span><span class="n">UITableView</span> <span class="o">*</span><span class="p">)</span><span class="nv">tableView</span> <span class="nf">heightForRowAtIndexPath</span><span class="p">:(</span><span class="n">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="nv">indexPath</span><span class="c1">//æ¯ä¸€è¡Œå¤šé«˜
</span><span class="k">-</span> <span class="p">(</span><span class="n">UITableViewCell</span> <span class="o">*</span><span class="p">)</span><span class="nf">tableView</span><span class="p">:(</span><span class="n">UITableView</span> <span class="o">*</span><span class="p">)</span><span class="nv">tableView</span> <span class="nf">cellForRowAtIndexPath</span><span class="p">:(</span><span class="n">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="nv">indexPath</span><span class="c1">//æ¯ä¸€è¡Œåˆ†åˆ«é•¿å•¥æ ·
</span><span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">tableView</span><span class="p">:(</span><span class="n">UITableView</span> <span class="o">*</span><span class="p">)</span><span class="nv">tableView</span> <span class="nf">willDisplayCell</span><span class="p">:(</span><span class="n">UITableViewCell</span> <span class="o">*</span><span class="p">)</span><span class="nv">cell</span> <span class="nf">forRowAtIndexPath</span><span class="p">:(</span><span class="n">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="nv">indexPath</span><span class="c1">//å³å°†æ˜¾ç¤ºæŸè¡Œ</span></code></pre></figure>

<h3 id="load-moreåŠ è½½æ›´å¤š">Load MoreåŠ è½½æ›´å¤š</h3>

<p>åŠ è½½æ›´å¤šçš„UITableviewæ‰©å±•æ§ä»¶éå¸¸å¤šï¼Œå°è¯•è¿‡å„ç§ç¬¬ä¸‰æ–¹å®Œç¾æ‰©å±•åï¼Œæˆ‘è§‰å¾—è¿™ç‚¹å°æŠŠæˆä¹Ÿä¸è‡³äºéœ€è¦æ‰©å±•UITableviewç±»å§ï¼Ÿ<br />
é‚£å°±æ˜¯åœ¨åˆ—è¡¨è¿½åŠ ä¸€ä¸ªSectionï¼Œæ”¾åœ¨æœ€åé¢ï¼Œè¿™ä¸ªSectionåªæœ‰ä¸€ä¸ªCell,è¿™ä¸ªè‡ªå®šä¹‰çš„cellæœ‰3ç§çŠ¶æ€ï¼Œè¿™äº›éƒ½å¯ä»¥è‡ªç”±å‘æŒ¥ã€‚<br />
æ¯å½“willDisplayCellçš„æ—¶å€™ï¼Œä½ å°±è®¾ç½®ä»–æ­£åœ¨loadingçŠ¶æ€ï¼Œç»™ç”¨æˆ·é€ æˆæ­£åœ¨åŠ è½½çš„å‡è±¡ï¼ŒåŒæ—¶è§¦å‘ç½‘ç»œè¯·æ±‚<br />
å½“æœ‰ç½‘ç»œæ•°æ®è¿”å›åï¼Œè‡ªç„¶ä¼šinsertå¥½å¤šå†…å®¹ï¼Œä¹Ÿè½®ä¸åˆ°è¿™ä¸ªåŠ è½½æ›´å¤šçš„cellæ˜¾ç¤ºçš„åœ°æ–¹äº†ï¼Œè‡ªç„¶å°±é‡Šæ”¾äº†ã€‚å½“ç„¶äº†ï¼Œå¦‚æœæ²¡æœ‰æ›´å¤šå†…å®¹ï¼Œä¹Ÿå¯ä»¥è½»æ¾çš„cellForRowAtIndexPathæ‰¾åˆ°å”¯ä¸€çš„cellï¼Œè®¾ç½®ä¸ºæ— æ›´å¤šæ•°æ®ç­‰çŠ¶æ€ã€‚<br /></p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="k">typedef</span> <span class="k">enum</span><span class="p">{</span>
	<span class="n">JWLoadMoreNormal</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="c1">//ç‚¹å‡»å†åŠ è½½</span>
    <span class="n">JWLoadMoreLoading</span><span class="p">,</span><span class="c1">//åŠ è½½ä¸­</span>
    <span class="n">JWLoadMoreDone</span><span class="p">,</span><span class="c1">//æ— æ›´å¤šæ•°æ®</span>
<span class="p">}</span> <span class="n">JWLoadMoreState</span><span class="p">;</span>

<span class="k">@interface</span> <span class="nc">LoadMoreCell</span> <span class="p">:</span> <span class="nc">UITableViewCell</span>

<span class="k">@property</span> <span class="p">(</span><span class="n">strong</span><span class="p">,</span> <span class="n">nonatomic</span><span class="p">)</span>  <span class="n">UIView</span> <span class="o">*</span><span class="n">baseWhiteView</span><span class="p">;</span>
<span class="k">@property</span> <span class="p">(</span><span class="n">strong</span><span class="p">,</span> <span class="n">nonatomic</span><span class="p">)</span>  <span class="n">UIActivityIndicatorView</span> <span class="o">*</span><span class="n">activity</span><span class="p">;</span>
<span class="k">@property</span> <span class="p">(</span><span class="n">strong</span><span class="p">,</span> <span class="n">nonatomic</span><span class="p">)</span>  <span class="n">UILabel</span> <span class="o">*</span><span class="n">tipsLabel</span><span class="p">;</span>
<span class="k">@property</span> <span class="p">(</span><span class="n">strong</span><span class="p">,</span> <span class="n">nonatomic</span><span class="p">)</span>  <span class="n">UIButton</span> <span class="o">*</span><span class="n">loadMoreButton</span><span class="p">;</span>
<span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span><span class="n">unsafe_unretained</span><span class="p">)</span> <span class="n">id</span> <span class="o">&lt;</span><span class="n">LoadMoreCellDelegate</span><span class="o">&gt;</span>                   <span class="n">delegate</span><span class="p">;</span>
<span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">setupUI</span><span class="p">;</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">loadMore</span><span class="p">:(</span><span class="n">id</span><span class="p">)</span><span class="nv">sender</span><span class="p">;</span>
<span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setLoadMoreStatus</span><span class="p">:(</span><span class="n">JWLoadMoreState</span><span class="p">)</span><span class="nv">status</span><span class="p">;</span></code></pre></figure>

<p>###Autolayout
åšå®Œè¿™äº›ï¼ŒåŸºæœ¬é…ç½®å°±å®Œæˆäº†ï¼Œä¸‹é¢éœ€è¦æ ¹æ®è®¾è®¡å¸ˆçš„è¦æ±‚è¿›è¡Œè‡ªå®šä¹‰å¼€å‘ï¼Œè­¬å¦‚è‡ªå®šä¹‰cell
<img src="http://img226.poco.cn/mypoco/myphoto/20140120/14/17456374520140120143516034.jpg" alt="" /> 
å¦‚ä¸Šå›¾ï¼Œå¯†å¯†éº»éº»çš„</p>

<p>autolayoutçš„æ‹–æ‹½ä¸ä¼šï¼Ÿä½ å¤ªè€åœŸäº†å§ã€‚xcode5çš„æ‹–æ‹½ï¼Œå¯è°“æ˜¯å¼‚å¸¸ç®€å•ï¼Œåªéœ€è¦ç‚¹å¿«æ·èœå•çš„pinï¼Œè®¾ç½®å¥½ä¸Šä¸‹å·¦å³ç›¸å¯¹å…³ç³»å°±å¯ä»¥äº†ã€‚<br />
åˆ›å»ºcustomçš„uitableviewcellåŸºæœ¬å·®ä¸å¤šï¼Œæ‹–å‡ºæ¥ï¼Œç”»ç”»æ¶‚æ¶‚ï¼Œåˆ›å»ºä»£ç ï¼Œæ”¹ç±»åå¯¹åº”å…³ç³»ï¼ŒæŒ‰ç€â€œControlâ€æ‹–æ‹½å…³è”ï¼Œç­‰ç­‰ã€‚<br /></p>

<p>æˆ‘è¿™é‡Œåªè®²ä¸€ä¸ªç‰¹æ®Šçš„ï¼Œå°±æ˜¯å›¾ä¸Šâ€œå›¾ç‰‡â€â€œæ‘˜è¦â€å±äºå¹¶æ’åŒºåŸŸï¼Œå¯èƒ½æ²¡æœ‰å›¾ç‰‡çš„å¸–å­ï¼Œâ€œæ‘˜è¦â€å°±éœ€è¦é¡¶æ ¼æ’ç‰ˆã€‚è¿™æ ·çš„æƒ…å†µè¯¥æ€ä¹ˆè®¾ç½®å‘¢ï¼Ÿ<br />
è¿™å°±å¾—ç”¨NSLayoutConstraintçš„æ‹½å‡ºæ¥çš„å…³è”äº†ã€‚æŠŠâ€æ‘˜è¦â€œçš„ç›¸å¯¹è·ç¦»ï¼Œé”å®šåœ¨ä¸€ä¸ªå›ºå®šçš„ä½ç½®ä¸Šï¼Œè­¬å¦‚â€å·¦è¾¹æ â€œï¼Œé€šè¿‡å°‘é‡çš„ä»£ç è®¡ç®—ï¼Œå³å¯åŠ¨æ€çš„ä¿®æ”¹NSLayoutConstraint.constantçš„è·ç¦»ã€‚<br /></p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc">    <span class="n">NSString</span> <span class="o">*</span><span class="n">url</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">img</span><span class="p">;</span>
    <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">previewImageView</span> <span class="nf">setClipsToBounds</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">url</span><span class="o">!=</span><span class="nb">nil</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">[</span><span class="n">url</span> <span class="nf">isEqualToString</span><span class="p">:</span><span class="s">@""</span><span class="p">])</span> <span class="p">{</span>  <span class="c1">//è¿™é‡Œæ˜¯åˆ¤æ–­æœ‰å›¾æ²¡å›¾</span>
        <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">previewImageView</span> <span class="nf">setImageWithURL</span><span class="p">:[</span><span class="n">NSURL</span> <span class="nf">URLWithString</span><span class="p">:</span><span class="n">url</span><span class="p">]</span> <span class="nf">placeholderImage</span><span class="p">:[</span><span class="n">UIImage</span> <span class="nf">imageNamed</span><span class="p">:</span><span class="s">@"pic_default"</span><span class="p">]];</span>
        <span class="n">self</span><span class="p">.</span><span class="n">previewImageHeight</span><span class="p">.</span><span class="n">constant</span><span class="o">=</span><span class="n">HomeCellImageHeight</span><span class="p">;</span>
        <span class="n">self</span><span class="p">.</span><span class="n">previewImageWidth</span><span class="p">.</span><span class="n">constant</span><span class="o">=</span><span class="n">HomeCellImageWidth</span><span class="p">;</span>
        <span class="n">self</span><span class="p">.</span><span class="n">abstractLeftMargin</span><span class="p">.</span><span class="n">constant</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>  <span class="c1">//è‹¥æœ‰å›¾ï¼Œæ‘˜è¦ä¸å›¾çš„å·¦è¾¹è·å˜ä¸º10</span>
        <span class="n">self</span><span class="p">.</span><span class="n">summaryDistanceBetweenTitle</span><span class="p">.</span><span class="n">constant</span><span class="o">=</span><span class="mi">80</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">previewImageView</span> <span class="nf">setImage</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
        <span class="n">self</span><span class="p">.</span><span class="n">previewImageHeight</span><span class="p">.</span><span class="n">constant</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>  <span class="c1">//å›¾ç‰‡å¤§å°å…¨æ¸…ç©ºä¸º0</span>
        <span class="n">self</span><span class="p">.</span><span class="n">previewImageWidth</span><span class="p">.</span><span class="n">constant</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">self</span><span class="p">.</span><span class="n">abstractLeftMargin</span><span class="p">.</span><span class="n">constant</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>  <span class="c1">//è‹¥æ— å›¾ï¼Œæ‘˜è¦ä¸å›¾çš„å·¦è¾¹è·å˜ä¸º10</span>
    <span class="p">}</span>
    <span class="p">[</span><span class="n">self</span> <span class="nf">setNeedsUpdateConstraints</span><span class="p">];</span>   <span class="c1">//è®°å¾—å¼ºåˆ¶åˆ·æ–°ï¼Œè¦ä¸ç„¶ç³»ç»Ÿæ‡’æ‡’çš„</span>
    <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">contentView</span> <span class="nf">layoutIfNeeded</span><span class="p">];</span>
    <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">contentView</span> <span class="nf">setNeedsLayout</span><span class="p">];</span></code></pre></figure>

<p>###åŠ¨æ€è®¡ç®—é«˜åº¦</p>

<p>åšåˆ°è¿™é‡Œï¼Œææ€•å¤§éƒ¨åˆ†äººéƒ½é‡åˆ°ä¸€ä¸ªé—¨æ§›äº†ã€‚é‚£å°±æ˜¯å¦‚ä½•åŠ¨æ€è®¡ç®—cellçš„é«˜åº¦ã€‚<br />
æœ€ç®€å•çš„ï¼Œå°±æ˜¯ç½‘æ˜“æ–°é—»ç±»ï¼Œå›ºå®šé«˜åº¦ã€‚return 44;<br />
è‹¥æ˜¯åŠ¨æ€çš„ï¼Œæ— éæ˜¯åˆ›å»ºä¸€ä¸ªcellï¼Œå¹¶ä¸”åˆå§‹åŒ–æ„é€ å¥½ï¼Œç„¶åè¾“å‡ºcellçš„æœ€åä¸€è¡Œæ§ä»¶çš„ä½ç½®ï¼Œæœ€ç»ˆç»™å‡ºä½ç½®ã€‚<br /></p>

<p>ä½†æ˜¯è¿™å°±å¯¼è‡´äº†å‡½æ•°è¿è¡Œçš„ä½æ•ˆã€‚ä½ æƒ³ï¼Œautolayoutæœ¬æ¥å°±å¤Ÿæ•ˆç‡ä½äº†ï¼ˆå› ä¸ºç¨‹åºçŒ¿çœäº‹å„¿äº†ï¼‰ï¼Œå†ä¸ºæ¯ä¸€è¡Œè®¡ç®—2æ¬¡ï¼Œè¿™æ•ˆç‡èƒ½é«˜ï¼Ÿ<br />
æˆ‘äº²æµ‹å‘ç°ï¼ŒåŠ¨æ€æ’ç‰ˆæ•ˆç‡æ˜¯éå¸¸ä½çš„ï¼Œä¸è¶³ä»¥ä¿¡ä»»ã€‚<br /></p>

<p>æœ€å¥½åŠçš„ï¼Œè¿˜æ˜¯åœŸæ–¹æ³•ã€‚è·å–å¯¹åº”çš„æ•°æ®ï¼Œæ ¹æ®è‡ªå·±è®¾å®šçš„æ’ç‰ˆè§„åˆ™ï¼ŒåŠ¨æ€çš„è®¡ç®—ã€‚åœŸå½’åœŸï¼Œæ•ˆç‡é«˜å•Šï¼</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc">        <span class="n">TopicID</span> <span class="o">*</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">threadList</span> <span class="nf">objectAtIndex</span><span class="p">:</span><span class="n">indexPath</span><span class="p">.</span><span class="n">row</span><span class="p">];</span>
<span class="c1">//        NSLog(@"è®¡ç®—è¡Œæ•°ä¸º%d",indexPath.row);</span>
        <span class="kt">int</span> <span class="n">height</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">height</span><span class="o">+=</span><span class="mi">17</span><span class="p">;</span> <span class="c1">//ç”¨æˆ·åä¸é¡¶éƒ¨ç©ºé—´</span>
        <span class="n">height</span><span class="o">+=</span><span class="mi">17</span><span class="p">;</span> <span class="c1">//ç”¨æˆ·åé«˜åº¦</span>
        <span class="n">height</span><span class="o">+=</span><span class="mi">8</span><span class="p">;</span> <span class="c1">//ç”¨æˆ·åä¸æ ‡é¢˜ä¹‹é—´è·ç¦»</span>
        
        <span class="n">NSString</span> <span class="o">*</span><span class="n">titleContent</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">title</span><span class="p">;</span>
        <span class="n">UIFont</span> <span class="o">*</span><span class="n">titleFont</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIFont</span> <span class="nf">boldSystemFontOfSize</span><span class="p">:</span><span class="mi">16</span><span class="p">.</span><span class="mi">0</span><span class="p">];</span>
        <span class="n">CGSize</span> <span class="n">titleRealSize</span><span class="o">=</span><span class="p">[</span><span class="n">titleContent</span> <span class="nf">sizeWithFont</span><span class="p">:</span><span class="n">titleFont</span> <span class="nf">constrainedToSize</span><span class="p">:</span><span class="n">CGSizeMake</span><span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span> <span class="n">lineBreakMode</span><span class="o">:</span><span class="n">NSLineBreakByTruncatingTail</span><span class="p">];</span>
        <span class="n">height</span><span class="o">+=</span><span class="n">titleRealSize</span><span class="p">.</span><span class="n">height</span><span class="p">;</span><span class="c1">//åŠ¨æ€è®¡ç®—æ ‡é¢˜é«˜åº¦</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">img</span><span class="o">!=</span><span class="nb">nil</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">[</span><span class="n">data</span><span class="p">.</span><span class="n">img</span> <span class="nf">isEqualToString</span><span class="p">:</span><span class="s">@""</span><span class="p">])</span> <span class="p">{</span>
            <span class="n">height</span><span class="o">+=</span><span class="n">HomeCellImageHeight</span><span class="p">;</span><span class="c1">//ç»Ÿè®¡å›¾çš„èµ·å§‹ç‚¹</span>
            <span class="n">height</span><span class="o">+=</span><span class="mi">20</span><span class="p">;</span>
<span class="c1">//            NSLog(@"æœ‰å›¾");</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">NSString</span> <span class="o">*</span><span class="n">abstract</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">abstract</span><span class="p">;</span>
            <span class="n">UIFont</span> <span class="o">*</span><span class="n">abstractFont</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIFont</span> <span class="nf">boldSystemFontOfSize</span><span class="p">:</span><span class="mi">14</span><span class="p">.</span><span class="mi">0</span><span class="p">];</span>
            <span class="n">CGSize</span> <span class="n">abstractRealSize</span><span class="o">=</span><span class="p">[</span><span class="n">abstract</span> <span class="nf">sizeWithFont</span><span class="p">:</span><span class="n">abstractFont</span> <span class="nf">constrainedToSize</span><span class="p">:</span><span class="n">CGSizeMake</span><span class="p">(</span><span class="mi">280</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span> <span class="n">lineBreakMode</span><span class="o">:</span><span class="n">NSLineBreakByTruncatingTail</span><span class="p">];</span>
            
            <span class="n">height</span><span class="o">+=</span><span class="n">abstractRealSize</span><span class="p">.</span><span class="n">height</span><span class="p">;</span>
            <span class="n">height</span><span class="o">+=</span><span class="mi">20</span><span class="p">;</span>
<span class="c1">//            NSLog(@"æ— å›¾");</span>
        <span class="p">}</span>
        <span class="n">height</span><span class="o">+=</span><span class="mi">56</span><span class="p">;</span> <span class="c1">//ç»Ÿè®¡å›¾çš„é«˜åº¦</span>
        <span class="n">height</span><span class="o">+=</span><span class="mi">3</span><span class="p">;</span><span class="c1">//ä¸‹è¾¹æ¡†çš„é«˜åº¦</span></code></pre></figure>

<p>æœ€ååˆ«å¿˜äº†Profileï¼Œè®¡ç®—æ—¶é—´ï¼Œæ¯ä¸€ä¸ªç»†èŠ‚çš„æ—¶é—´ä¼˜åŒ–ï¼Œæœ€ç»ˆéƒ½ä¼šä½“ç°åœ¨åˆ—è¡¨çš„æµç•…åº¦è¡¨ç°ä¸Šã€‚
é€šè¿‡ä»¥ä¸Šå‡ ç‚¹å‘¢ï¼Œå†ç»“åˆç°æˆå¥½ç”¨çš„SDWebImageCacheï¼Œç›¸ä¿¡å¤§å®¶ä¸€å®šå¯ä»¥åšå‡ºçœŸæ­£ç¾è§‚ã€é«˜æ•ˆçš„åˆ—è¡¨å“¦ï¼</p>

:ET